<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社内IT改善掲示板 | 管理</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container admin-wrap">
        <div class="admin-hero">
            <div>
                <p class="eyebrow">IT 管理者向け</p>
                <h1>Improvement Ops Hub</h1>
                <p class="lede">投稿と運用分析を一画面で。よく使う操作にすぐアクセスできます。</p>
            </div>
            <div class="header-actions">
                <a class="btn primary link-btn" href="dashboard-static.html">一覧を見る</a>
            </div>
        </div>

        <div class="cta-row">
            <button class="btn big tab-btn active" data-tab="ops">📊 分析パネル</button>
            <button class="btn big tab-btn" data-tab="post">📝 投稿フォーム</button>
            <button class="btn big tab-btn" data-tab="manage">📑 投稿管理</button>
        </div>

        <div class="admin-layout two-col">
            <aside class="panel admin-section" data-tab="ops">
                <div class="panel-header">
                    <div>
                        <p class="eyebrow">運用・分析</p>
                        <h3>ダッシュボード</h3>
                    </div>
                </div>
                <div class="panel-body ops-grid">
                    <div class="ops-main">
                        <div id="analytics-metrics" class="analytics-grid"></div>
                        <div class="chart-row">
                            <div class="chart-card">
                                <h4>タグ別シェア</h4>
                                <div id="tag-pie" class="chart-pie"></div>
                                <div id="tag-legend" class="legend"></div>
                            </div>
                            <div class="chart-card">
                                <h4>記事別 PV</h4>
                                <div id="case-bars" class="bar-chart"></div>
                            </div>
                        </div>
                        <h4 style="margin-top:14px;">記事別 PV</h4>
                        <table class="table">
                            <thead><tr><th>記事</th><th>PV</th><th>推移</th></tr></thead>
                            <tbody id="analytics-cases"></tbody>
                        </table>
                        <h4 style="margin-top:14px;">タグ別 PV / 件数</h4>
                        <table class="table">
                            <thead><tr><th>タグ</th><th>PV</th><th>推移</th></tr></thead>
                            <tbody id="analytics-tags"></tbody>
                        </table>
                        <h4 style="margin-top:14px;">記事別 いいね</h4>
                        <table class="table">
                            <thead><tr><th>記事</th><th>いいね</th></tr></thead>
                            <tbody id="analytics-likes"></tbody>
                        </table>
                    </div>
                    <div class="ops-side">
                        <div class="filter-bar">
                            <div class="filter-row">
                                <label for="period-mode">集計期間</label>
                                <select id="period-mode">
                                    <option value="all">全期間</option>
                                    <option value="year">年度</option>
                                    <option value="month">月間</option>
                                    <option value="custom">日付指定</option>
                                </select>
                                <select id="period-year"></select>
                                <select id="period-month"></select>
                                <input type="date" id="period-start">
                                <input type="date" id="period-end">
                            </div>
                        </div>
                        <div class="filter-card">
                            <h4>タグで絞り込み</h4>
                            <div id="filter-tags" class="filter-tag-list"></div>
                        </div>
                        <div class="filter-card">
                            <h4>クイック統計</h4>
                            <div id="side-totals" class="mini-cards"></div>
                        </div>
                        <div class="filter-card">
                            <h4>タグ別TOP</h4>
                            <div id="side-top-tags" class="side-list"></div>
                        </div>
                        <div class="filter-card">
                            <h4>最近の投稿</h4>
                            <div id="side-latest" class="side-list"></div>
                        </div>
                    </div>
                </div>
            </aside>

            <div class="panel admin-section hidden" data-tab="post">
                <div class="panel-header">
                    <div>
                        <p class="eyebrow">投稿フォーム</p>
                        <h3>新規事例を追加</h3>
                    </div>
                    <span id="form-status" class="success" aria-live="polite"></span>
                </div>
                <form id="admin-form" class="panel-body">
                    <div class="form-grid">
                        <div>
                            <label for="title">タイトル *</label><br>
                            <input id="title" required placeholder="例）Teams ボットで定型問い合わせを自動化">
                        </div>
                        <div>
                            <label for="owner">担当</label><br>
                            <input id="owner" placeholder="例）IT サービスデスク">
                        </div>
                        <div>
                            <label for="impact">効果</label><br>
                            <input id="impact" placeholder="例）工数 -30%, 応答 10 秒">
                        </div>
                        <div>
                            <label for="date">公開日</label><br>
                            <input id="date" type="date">
                        </div>
                    </div>

                    <div>
                        <label for="summary">概要 *</label><br>
                        <textarea id="summary" rows="3" required placeholder="短い概要を入力"></textarea>
                    </div>
                    <div>
                        <label for="detail">詳細 *</label><br>
                        <textarea id="detail" rows="6" required placeholder="どのような改善を行い、手順や効果を詳しく入力"></textarea>
                    </div>
                    <div class="form-grid">
                        <div>
                            <label>タグ（複数選択可）</label><br>
                            <div class="tag-chip-row" id="tag-chip-row"></div>
                            <input id="tags-extra" placeholder="自由入力タグ (カンマ区切り)">
                            <p class="helper">選択＋自由入力を合わせてタグ化します。指定が無い場合は「未分類」。</p>
                        </div>
                        <div>
                            <label for="image-file">画像ファイル（任意）</label><br>
                            <input id="image-file" type="file" accept="image/*">
                            <p class="helper">未指定の場合はタイトル入りのプレースホルダ画像を自動生成します。</p>
                        </div>
                        <div>
                            <label for="pdf-file">PDF添付（任意・ダウンロード可）</label><br>
                            <input id="pdf-file" type="file" accept="application/pdf">
                            <p class="helper">詳細資料などを添付できます。閲覧画面からダウンロード可能です。</p>
                        </div>
                    </div>

                    <div class="card-actions" style="margin-top: 6px;">
                        <button type="submit" class="btn primary">投稿を保存</button>
                    </div>
                </form>
            </div>

            <div class="panel admin-section hidden" data-tab="manage">
                <div class="panel-header">
                    <div>
                        <p class="eyebrow">投稿管理</p>
                        <h3>編集・削除</h3>
                    </div>
                    <span class="helper">投稿完了後は自動でここに移動します</span>
                </div>
                <div class="panel-body">
                    <table class="table" id="manage-table">
                        <thead>
                            <tr>
                                <th>タイトル / タグ</th>
                                <th>担当</th>
                                <th>PV</th>
                                <th>いいね</th>
                                <th>コメント</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="manage-list"></tbody>
                    </table>
                    <div id="manage-pagination" class="pagination"></div>
                </div>
            </div>
        </div>
    </div>

    <button id="fab-post" class="fab-post" aria-label="投稿フォームを開く">✏️</button>

    <div class="drawer-overlay" id="admin-drawer-overlay"></div>
    <div class="detail-drawer" id="admin-detail-drawer">
        <div class="drawer-header">
            <div>
                <p class="eyebrow" id="admin-detail-tags">タグ</p>
                <h2 id="admin-detail-title">タイトル</h2>
                <p class="lede" id="admin-detail-summary">概要</p>
            </div>
            <button class="icon-btn" id="admin-drawer-close" aria-label="閉じる">✕</button>
        </div>
        <div class="drawer-body">
            <div class="detail-hero" id="admin-detail-hero"></div>
            <div class="detail-meta">
                <span class="pill" id="admin-detail-owner">担当 -</span>
                <span class="pill" id="admin-detail-impact">効果 -</span>
                <span class="pill" id="admin-detail-date">公開日: -</span>
                <span class="pill" id="admin-detail-pv">PV: -</span>
                <span class="pill" id="admin-detail-likes">いいね: -</span>
            </div>
            <div class="detail-links">
                <a id="admin-detail-pdf" class="btn outline hidden" target="_blank" rel="noopener">📄 添付PDFを開く</a>
            </div>
            <article id="admin-detail-body" class="detail-body"></article>

            <div class="social-bar">
                <div class="comment-count">👍 <span id="admin-like-count">0</span> 件</div>
                <div class="comment-count">💬 <span id="admin-comment-count">0</span> 件</div>
            </div>

            <section class="comments">
                <h3>コメント</h3>
                <div id="admin-comment-list" class="comment-list"></div>
            </section>
        </div>
    </div>

    <script src="js/board-admin.js"></script>
</body>
</html>
